function inBand(a,b){if("undefined"!=typeof b)return a>=bandFrequencyRange[b][0]&&a<=bandFrequencyRange[b][1]?!0:!1;for(var c in bandFrequencyRange)if(a>=bandFrequencyRange[c][0]&&a<=bandFrequencyRange[c][1])return!0;return!1}function giveBand(a){for(var b in bandFrequencyRange)if(a>bandFrequencyRange[b][0]&&a<bandFrequencyRange[b][1])return parseInt(bandFrequencyRange[b][0]);return"undefined"}var app=angular.module("SOTAwatch filter",["ngRoute","ui.bootstrap","ngAnimate","uiSwitch"]);app.config(["$routeProvider",function(a){a.when("/",{redirectTo:"/spotfilter"}).when("/spotfilter",{templateUrl:"templates/spotfilter.html",controller:"spotfilterController"}).when("/settings",{templateUrl:"templates/settings.html",controller:"settingsController"}).when("/logger",{templateUrl:"templates/logger.html",controller:"loggerController"}).when("/help",{templateUrl:"templates/help.html",controller:"helpController"}).otherwise({redirectTo:"/spotfilter"})}]).config(["$logProvider",function(a){a.debugEnabled(!1)}]).run(["$rootScope","$location","$anchorScroll","$routeParams","$log","$window",function(a,b,c,d,e,f){a.$on("$routeChangeSuccess",function(a,e){b.hash(d.scrollTo),c(),f.scrollTo(window.pageXOffset,window.pageYOffset-40)})}]).run(["$rootScope","$location","$window","$log",function(a,b,c,d){a.$on("$routeChangeSuccess",function(a){d.debug("Google Analytics Page View"),c.ga&&c.ga("send","pageview",{page:document.location.pathname+document.location.search+document.location.hash})})}]).controller("AppController",["$scope","$log","alertService",function(a,b,c){a.sidebarToggled=!0,a.alerts=c}]),app.factory("alertService",["$timeout","$log",function(a,b){var c={};return c.alerts=[],c.id=0,c.addAlert=function(d,e,f){c.alerts.push({id:c.id,message:d,cssClass:e,timeout:f});var g=c.id;b.debug("Add alert:"),b.debug(c.alerts[c.alerts.length-1]),a(function(){c.removeAlert(g)},f),c.id++},c.removeAlert=function(a){b.debug("Remove alert:"),b.debug(c.alerts);for(var d in c.alerts)if(c.alerts[d].id===a){c.alerts.splice(d,1);break}},c}]),app.factory("SoundNotification",["$log","$filter",function(a,b){soundNotification={sounds:[{name:'Morse: "SOTA"',file:"SOTA.mp3"},{name:"Horn",file:"Horn.mp3"}],spotsMute:!1};try{localStorage.setItem("test","test"),localStorage.removeItem("test"),soundNotification.localStorageIsSupported=!0}catch(c){soundNotification.localStorageIsSupported=!1}return soundNotification.localStorageIsSupported&&(soundNotification.selectedSoundSpots=soundNotification.sounds[soundNotification.sounds.map(function(a){return a.name}).indexOf(localStorage.getItem("selectedSoundSpots"))],soundNotification.spotsMute="true"===localStorage.getItem("spotsMute")?!0:!1,a.debug(localStorage.getItem("spotsMute")),a.debug(soundNotification.spotsMute)),soundNotification.selectedSoundSpots=soundNotification.selectedSoundSpots||soundNotification.sounds[0],soundNotification.audioSpots=new Audio("src/sound/"+soundNotification.selectedSoundSpots.file),soundNotification.save=function(){localStorage.setItem("selectedSoundSpots",soundNotification.selectedSoundSpots.name),localStorage.setItem("spotsMute",soundNotification.spotsMute),soundNotification.audioSpots=new Audio("src/sound/"+soundNotification.selectedSoundSpots.file),a.debug("SoundNotification save:"),a.debug(soundNotification.selectedSoundSpots),a.debug(soundNotification.spotsMute)},soundNotification.playSpots=function(c){if(a.debug("PlaySpots:"),!soundNotification.spotsMute){a.debug("Notifications not muted"),spotlist=b("matchSpots")(c);for(var d in spotlist){if(!spotlist[d].isNew)break;spotlist[d].match&&soundNotification.audioSpots.play()}}},soundNotification.testSpots=function(){soundNotification.audioSpots.currentTime=0,soundNotification.audioSpots.play()},soundNotification}]),angular.module("uiSwitch",[]).directive("switch",function(){return{restrict:"AE",replace:!0,transclude:!0,template:function(a,b){var c="";return c+="<span",c+=' class="switch'+(b["class"]?" "+b["class"]:"")+'"',c+=b.ngModel?' ng-click="'+b.ngModel+"=!"+b.ngModel+'"':"",c+=' ng-class="{ checked:'+b.ngModel+' }"',c+=">",c+="<small></small>",c+='<input type="checkbox"',c+=b.id?' id="'+b.id+'"':"",c+=b.name?' name="'+b.name+'"':"",c+=b.ngModel?' ng-model="'+b.ngModel+'"':"",c+=' style="display:none" />',c+="</span>"}}}),app.directive("mdUrl",["$location",function(a){return{link:function(b,c,d){c.on("click",function(c){c.preventDefault(),c.stopPropagation(),b.$apply(function(){a.path(d.mdUrl)})})}}}]);var bandFrequencyRange={160:[1.8,2],80:[3.5,4],60:[5.3,5.41],40:[7,7.3],30:[10.1,10.15],20:[14,14.35],17:[18.068,18.168],15:[21,21.45],12:[24.89,24.99],10:[28,29.7],6:[50,54],4:[70.25,70.5],2:[144,148],70:[420,450],23:[1240,1300],13:[2300,2450]};app.filter("dateToUTCTime",function(){return function(a){if(a instanceof Date){var b=a.getUTCHours()<10?"0"+a.getUTCHours():""+a.getUTCHours(),c=a.getUTCMinutes()<10?"0"+a.getUTCMinutes():""+a.getUTCMinutes(),d=a.getUTCSeconds()<10?"0"+a.getUTCSeconds():""+a.getUTCSeconds();return b+":"+c+":"+d+" UTC"}return a?"Given parameter is not a JavaScript Date object":""}}).filter("pluralize",function(){return function(a,b,c){if("undefined"==typeof c&&(c=!0),1==a)return(c?a+" ":"")+b;var d=b;return"us"==b.substr(b.length-2)?d=d.substr(0,d.length-2)+"i":"ch"==b.substr(b.length-2)||"x"==b.charAt(b.length-1)||"s"==b.charAt(b.length-1)?d+="es":"y"==b.charAt(b.length-1)&&-1==["a","e","i","o","u"].indexOf(b.charAt(b.length-2))?d=d.substr(0,d.length-1)+"ies":"is"==b.substr(b.length-2)?d=d.substr(0,d.length-2)+"es":d+="s",(c?a+" ":"")+d}}).filter("nPlus",function(){return function(a,b){return"undefined"==typeof b&&(b=5),a>b?b+"+":a}}).filter("stripCallsign",["$log",function(a){return function(a){return a=a.replace(/\/P/,""),a=a.replace(/^.+\//,"")}}]).filter("matchSpots",["$log","settingsService","SpotsService","loggerService","SoundNotification",function(a,b,c,d,e){return function(f){filterSettings=b,objectSpots=c,soundNotification=e,logger=d;for(var g in f)f[g].callsign.match(new RegExp(filterSettings.callsign.include,"i"))?""!==filterSettings.callsign.exclude&&f[g].callsign.match(new RegExp(filterSettings.callsign.exclude,"i"))?(f[g].match=!1,a.debug('Spot does not match: filterSettings.callsign.exclude !== "" && spots[index].callsign.match(new RegExp(filterSettings.callsign.exclude, "i"))')):f[g].summitReference.match(new RegExp(filterSettings.summit.include,"i"))?""!==filterSettings.summit.exclude&&f[g].summitReference.match(new RegExp(filterSettings.summit.exclude,"i"))?(f[g].match=!1,a.debug('Spot does not match: filterSettings.summit.exclude !== "" && spots[index].summitReference.match(new RegExp(filterSettings.summit.exclude, "i"))')):(f[g].comment+f[g].postedBy).match(new RegExp(filterSettings.comment.include,"i"))?""!==filterSettings.comment.exclude&&(f[g].comment+f[g].postedBy).match(new RegExp(filterSettings.comment.exclude,"i"))?(f[g].match=!1,a.debug('Spot does not match: filterSettings.comment.exclude !== "" && (spots[index].comment + spots[index].postedBy).match(new RegExp(filterSettings.comment.exclude, "i"))')):!filterSettings.band[160]&&inBand(f[g].frequency,160)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[160]  && inBand(spots[index].frequency, 160) ")):!filterSettings.band[80]&&inBand(f[g].frequency,80)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[80]  && inBand(spots[index].frequency, 80)")):!filterSettings.band[60]&&inBand(f[g].frequency,60)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[60]  && inBand(spots[index].frequency, 60)")):!filterSettings.band[40]&&inBand(f[g].frequency,40)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[40]  && inBand(spots[index].frequency, 40)")):!filterSettings.band[30]&&inBand(f[g].frequency,30)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[30]  && inBand(spots[index].frequency, 30)")):!filterSettings.band[20]&&inBand(f[g].frequency,20)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[20]  && inBand(spots[index].frequency, 20)")):!filterSettings.band[17]&&inBand(f[g].frequency,17)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[17]  && inBand(spots[index].frequency, 17)")):!filterSettings.band[15]&&inBand(f[g].frequency,15)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[15]  && inBand(spots[index].frequency, 15)")):!filterSettings.band[12]&&inBand(f[g].frequency,12)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[12]  && inBand(spots[index].frequency, 12)")):!filterSettings.band[10]&&inBand(f[g].frequency,10)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[10]  && inBand(spots[index].frequency, 10)")):!filterSettings.band[6]&&inBand(f[g].frequency,6)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[6]  && inBand(spots[index].frequency, 6)")):!filterSettings.band[4]&&inBand(f[g].frequency,4)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[4]  && inBand(spots[index].frequency, 4)")):!filterSettings.band[2]&&inBand(f[g].frequency,2)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[2]  && inBand(spots[index].frequency, 2)")):!filterSettings.band[70]&&inBand(f[g].frequency,70)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[70]  && inBand(spots[index].frequency, 70)")):!filterSettings.band[23]&&inBand(f[g].frequency,23)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[23]  && inBand(spots[index].frequency, 23)")):!filterSettings.band[13]&&inBand(f[g].frequency,13)?(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band[13]  && inBand(spots[index].frequency, 13)")):filterSettings.band.others||inBand(f[g].frequency)?!filterSettings.mode.cw&&f[g].mode.match(new RegExp("cw","i"))?(f[g].match=!1,a.debug('Spot does not match: !filterSettings.mode.cw && spots[index].mode.match(new RegExp("cw","i"))')):!filterSettings.mode.ssb&&f[g].mode.match(new RegExp("ssb","i"))?(f[g].match=!1,a.debug('Spot does not match: !filterSettings.mode.ssb && spots[index].mode.match(new RegExp("ssb","i"))')):!filterSettings.mode.fm&&f[g].mode.match(new RegExp("fm","i"))?(f[g].match=!1,a.debug('Spot does not match: !filterSettings.mode.fm && spots[index].mode.match(new RegExp("fm","i"))')):filterSettings.mode.others||f[g].mode.match(new RegExp("cw|ssb|fm","i"))?""!==f[g].points&&f[g].points<=filterSettings.points?(f[g].match=!1,a.debug("Spot does not match: spots[index].points <= filterSettings.points")):logger.isInLog(f[g].callsign,f[g].summitReference)&&filterSettings.hideLog?(f[g].match=!1,a.debug("Spot does not match: spots[index] appears in the log")):f[g].match=!0:(f[g].match=!1,a.debug('Spot does not match: !filterSettings.mode.others && !spots[index].mode.match(new RegExp("cw|ssb|fm","i"))')):(f[g].match=!1,a.debug("Spot does not match: !filterSettings.band.others && !inBand(spots[index].frequency)")):(f[g].match=!1,a.debug('Spot does not match: !(spots[index].comment + spots[index].postedBy).match(new RegExp(filterSettings.comment.include, "i"))')):(f[g].match=!1,a.debug('Spot does not match: !spots[index].summitReference.match(new RegExp(filterSettings.summit.include, "i"))')):(f[g].match=!1,a.debug('Spot does not match: !spots[index].callsign.match(new RegExp(filterSettings.callsign.include, "i"))'));return f}}]).filter("filterSpots",["$log","$filter","settingsService",function(a,b,c){return function(a){filterSettings=c,a=b("matchSpots")(a);for(var d in a)a[d].hide=!1,a[d].highlightMatch=!1,a[d].highlightReject=!1,a[d].match?!filterSettings.hideMatched&&filterSettings.highlightMatched&&(a[d].highlightMatch=!0):filterSettings.hideMatched?a[d].hide=!0:filterSettings.highlightRejected&&(a[d].highlightReject=!0);return a}}]),app.controller("helpController",["$scope",function(a){}]);var saveAs=saveAs||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(a){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=a.document,c=b.createElementNS("http://www.w3.org/1999/xhtml","a"),d="download"in c,e=function(c){var d=b.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1,a,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(d)},f=a.webkitRequestFileSystem,g=a.requestFileSystem||f||a.mozRequestFileSystem,h=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},i=0,j=function(b){var c=function(){"string"==typeof b?(a.URL||a.webkitURL||a).revokeObjectURL(b):b.remove()};a.chrome?c():setTimeout(c,10)},k=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){h(f)}}},l=function(b,h){var l,m,n,o=this,p=b.type,q=!1,r=function(){k(o,["writestart","progress","write","writeend"])},s=function(){(q||!l)&&(l=(a.URL||a.webkitURL||a).createObjectURL(b)),m?m.location.href=l:void 0==a.open(l,"_blank")&&"undefined"!=typeof safari&&(a.location.href=l),o.readyState=o.DONE,r(),j(l)},t=function(a){return function(){return o.readyState!==o.DONE?a.apply(this,arguments):void 0}},u={create:!0,exclusive:!1};o.readyState=o.INIT,h||(h="download"),d?(l=(a.URL||a.webkitURL||a).createObjectURL(b),c.href=l,c.download=h,e(c),o.readyState=o.DONE,r(),j(l)):(a.chrome&&p&&"application/octet-stream"!==p&&(n=b.slice||b.webkitSlice,b=n.call(b,0,b.size,"application/octet-stream"),q=!0),f&&"download"!==h&&(h+=".download"),("application/octet-stream"===p||f)&&(m=a),g?(i+=b.size,g(a.TEMPORARY,i,t(function(a){a.root.getDirectory("saved",u,t(function(a){var c=function(){a.getFile(h,u,t(function(a){a.createWriter(t(function(c){c.onwriteend=function(b){m.location.href=a.toURL(),o.readyState=o.DONE,k(o,"writeend",b),j(a)},c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&s()},["writestart","progress","write","abort"].forEach(function(a){c["on"+a]=o["on"+a]}),c.write(b),o.abort=function(){c.abort(),o.readyState=o.DONE},o.readyState=o.WRITING}),s)}),s)};a.getFile(h,{create:!1},t(function(a){a.remove(),c()}),t(function(a){a.code===a.NOT_FOUND_ERR?c():s()}))}),s)}),s)):s())},m=l.prototype;return m.abort=function(){this.readyState=this.DONE,k(this,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,function(a,b){return new l(a,b)}}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=saveAs:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return saveAs}),angular.module("ui.bootstrap",["ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(a,b,c){function d(a){for(var b in a)if(void 0!==f.style[b])return a[b]}var e=function(d,f,g){g=g||{};var h=a.defer(),i=e[g.animation?"animationEndEventName":"transitionEndEventName"],j=function(a){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(f)?d.addClass(f):angular.isFunction(f)?f(d):angular.isObject(f)&&d.css(f),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},f=document.createElement("trans"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},h={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return e.transitionEndEventName=d(g),e.animationEndEventName=d(h),e}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(a){return{link:function(b,c,d){function e(b){function d(){j===e&&(j=void 0)}var e=a(c,b);return j&&j.cancel(),j=e,e.then(d,d),e}function f(){k?(k=!1,g()):(c.removeClass("collapse").addClass("collapsing"),e({height:c[0].scrollHeight+"px"}).then(g))}function g(){c.removeClass("collapsing"),c.addClass("collapse in"),c.css({height:"auto"})}function h(){if(k)k=!1,i(),c.css({height:0});else{c.css({height:c[0].scrollHeight+"px"});{c[0].offsetWidth}c.removeClass("collapse in").addClass("collapsing"),e({height:0}).then(i)}}function i(){c.removeClass("collapsing"),c.addClass("collapse")}var j,k=!0;b.$watch(d.collapse,function(a){a?h():f()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(a,b,c){this.groups=[],this.closeOthers=function(d){var e=angular.isDefined(b.closeOthers)?a.$eval(b.closeOthers):c.closeOthers;e&&angular.forEach(this.groups,function(a){a!==d&&(a.isOpen=!1)})},this.addGroup=function(a){var b=this;this.groups.push(a),a.$on("$destroy",function(c){b.removeGroup(a)})},this.removeGroup=function(a){var b=this.groups.indexOf(a);-1!==b&&this.groups.splice(b,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(a){this.heading=a}},link:function(a,b,c,d){d.addGroup(a),a.$watch("isOpen",function(b){b&&d.closeOthers(a)}),a.toggleOpen=function(){a.isDisabled||(a.isOpen=!a.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(a,b,c,d,e){d.setHeading(e(a,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(a,b,c,d){a.$watch(function(){return d[c.accordionTransclude]},function(a){a&&(b.html(""),b.append(a))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(a,b){a.closeable="close"in b}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.bindHtmlUnsafe),a.$watch(c.bindHtmlUnsafe,function(a){b.html(a||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(a){this.activeClass=a.activeClass||"active",this.toggleEvent=a.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){var e=d[0],f=d[1];f.$render=function(){b.toggleClass(e.activeClass,angular.equals(f.$modelValue,a.$eval(c.btnRadio)))},b.bind(e.toggleEvent,function(){var d=b.hasClass(e.activeClass);(!d||angular.isDefined(c.uncheckable))&&a.$apply(function(){f.$setViewValue(d?null:a.$eval(c.btnRadio)),f.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(a,b,c,d){function e(){return g(c.btnCheckboxTrue,!0)}function f(){return g(c.btnCheckboxFalse,!1)}function g(b,c){var d=a.$eval(b);return angular.isDefined(d)?d:c}var h=d[0],i=d[1];i.$render=function(){b.toggleClass(h.activeClass,angular.equals(i.$modelValue,e()))},b.bind(h.toggleEvent,function(){a.$apply(function(){i.$setViewValue(b.hasClass(h.activeClass)?f():e()),i.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(a,b,c){function d(){e();var c=+a.interval;!isNaN(c)&&c>=0&&(g=b(f,c))}function e(){g&&(b.cancel(g),g=null)}function f(){h?(a.next(),d()):a.pause()}var g,h,i=this,j=i.slides=a.slides=[],k=-1;i.currentSlide=null;var l=!1;i.select=a.select=function(e,f){function g(){if(!l){if(i.currentSlide&&angular.isString(f)&&!a.noTransition&&e.$element){e.$element.addClass(f);{e.$element[0].offsetWidth}angular.forEach(j,function(a){angular.extend(a,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(e,{direction:f,active:!0,entering:!0}),angular.extend(i.currentSlide||{},{direction:f,leaving:!0}),a.$currentTransition=c(e.$element,{}),function(b,c){a.$currentTransition.then(function(){h(b,c)},function(){h(b,c)})}(e,i.currentSlide)}else h(e,i.currentSlide);i.currentSlide=e,k=m,d()}}function h(b,c){angular.extend(b,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(c||{},{direction:"",active:!1,leaving:!1,entering:!1}),a.$currentTransition=null}var m=j.indexOf(e);void 0===f&&(f=m>k?"next":"prev"),e&&e!==i.currentSlide&&(a.$currentTransition?(a.$currentTransition.cancel(),b(g)):g())},a.$on("$destroy",function(){l=!0}),i.indexOfSlide=function(a){return j.indexOf(a)},a.next=function(){var b=(k+1)%j.length;return a.$currentTransition?void 0:i.select(j[b],"next")},a.prev=function(){var b=0>k-1?j.length-1:k-1;return a.$currentTransition?void 0:i.select(j[b],"prev")},a.isActive=function(a){return i.currentSlide===a},a.$watch("interval",d),a.$on("$destroy",e),a.play=function(){h||(h=!0,d())},a.pause=function(){a.noPause||(h=!1,e())},i.addSlide=function(b,c){b.$element=c,j.push(b),1===j.length||b.active?(i.select(j[j.length-1]),1==j.length&&a.play()):b.active=!1},i.removeSlide=function(a){var b=j.indexOf(a);j.splice(b,1),j.length>0&&a.active?i.select(b>=j.length?j[b-1]:j[b]):k>b&&k--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(a,b,c,d){d.addSlide(a,b),a.$on("$destroy",function(){d.removeSlide(a)}),a.$watch("active",function(b){b&&d.select(a)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(a,b){function c(a,b,c){return 1===b&&c>28?29===c&&(a%4===0&&a%100!==0||a%400===0):3===b||5===b||8===b||10===b?31>c:!0}this.parsers={};var d={yyyy:{regex:"\\d{4}",apply:function(a){this.year=+a}},yy:{regex:"\\d{2}",apply:function(a){this.year=+a+2e3}},y:{regex:"\\d{1,4}",apply:function(a){this.year=+a}},MMMM:{regex:a.DATETIME_FORMATS.MONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.MONTH.indexOf(b)}},MMM:{regex:a.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.SHORTMONTH.indexOf(b)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1}},M:{regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},EEEE:{regex:a.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:a.DATETIME_FORMATS.SHORTDAY.join("|")}};this.createParser=function(a){var c=[],e=a.split("");return angular.forEach(d,function(b,d){var f=a.indexOf(d);if(f>-1){a=a.split(""),e[f]="("+b.regex+")",a[f]="$";for(var g=f+1,h=f+d.length;h>g;g++)e[g]="",a[g]="$";a=a.join(""),c.push({index:f,apply:b.apply})}}),{regex:new RegExp("^"+e.join("")+"$"),map:b(c,"index")}},this.parse=function(b,d){if(!angular.isString(b))return b;d=a.DATETIME_FORMATS[d]||d,this.parsers[d]||(this.parsers[d]=this.createParser(d));var e=this.parsers[d],f=e.regex,g=e.map,h=b.match(f);if(h&&h.length){for(var i,j={year:1900,month:0,date:1,hours:0},k=1,l=h.length;l>k;k++){var m=g[k-1];m.apply&&m.apply.call(j,h[k])}return c(j.year,j.month,j.date)&&(i=new Date(j.year,j.month,j.date,j.hours)),i}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d){var e,f,g,h,i=c.split("-"),j=i[0],k=i[1]||"center";e=d?this.offset(a):this.position(a),f=b.prop("offsetWidth"),g=b.prop("offsetHeight");var l={center:function(){return e.left+e.width/2-f/2},left:function(){return e.left},right:function(){return e.left+e.width}},m={center:function(){return e.top+e.height/2-g/2},top:function(){return e.top},bottom:function(){return e.top+e.height}};switch(j){case"right":h={top:m[k](),left:l[j]()};break;case"left":h={top:m[k](),left:e.left-f};break;case"bottom":h={top:m[j](),left:l[k]()};break;default:h={top:e.top-g,left:l[k]()}}return h}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(a,b,c,d,e,f,g,h){var i=this,j={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(c,e){i[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):h[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){i[d]=a?new Date(a):null,i.refreshView()}):i[d]=h[d]?new Date(h[d]):null}),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.uniqueId="datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(b.initDate)?a.$parent.$eval(b.initDate):new Date,a.isActive=function(b){return 0===i.compare(b.date,i.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){j=a,j.$render=function(){i.render()}},this.render=function(){if(j.$modelValue){var a=new Date(j.$modelValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),j.$setValidity("date",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=j.$modelValue?new Date(j.$modelValue):null;j.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},this.createDateObject=function(a,b){var c=j.$modelValue?new Date(j.$modelValue):null;return{date:a,label:g(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date)}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(a.datepickerMode===i.minMode){var c=j.$modelValue?new Date(j.$modelValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),j.$setViewValue(c),j.$render()}else i.activeDate=b,a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=i.activeDate.getFullYear()+a*(i.step.years||0),c=i.activeDate.getMonth()+a*(i.step.months||0);i.activeDate.setFullYear(b,c,1),i.refreshView()},a.toggleMode=function(b){b=b||1,a.datepickerMode===i.maxMode&&1===b||a.datepickerMode===i.minMode&&-1===b||(a.datepickerMode=i.modes[i.modes.indexOf(a.datepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var k=function(){e(function(){i.element[0].focus()},0,!1)};a.$on("datepicker.focus",k),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(i.isDisabled(i.activeDate))return;a.select(i.activeDate),k()}else!b.ctrlKey||"up"!==c&&"down"!==c?(i.handleKeyDown(c,b),i.refreshView()):(a.toggleMode("up"===c?1:-1),k())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("daypicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(b,c,d,e){function f(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?i[b]:29}function g(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function h(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1}b.showWeeks=e.showWeeks,e.step={months:1},e.element=c;var i=[31,28,31,30,31,30,31,31,30,31,30,31];e._refreshView=function(){var c=e.activeDate.getFullYear(),d=e.activeDate.getMonth(),f=new Date(c,d,1),i=e.startingDay-f.getDay(),j=i>0?7-i:-i,k=new Date(f);j>0&&k.setDate(-j+1);for(var l=g(k,42),m=0;42>m;m++)l[m]=angular.extend(e.createDateObject(l[m],e.formatDay),{secondary:l[m].getMonth()!==d,uid:b.uniqueId+"-"+m});b.labels=new Array(7);for(var n=0;7>n;n++)b.labels[n]={abbr:a(l[n].date,e.formatDayHeader),full:a(l[n].date,"EEEE")};if(b.title=a(e.activeDate,e.formatDayTitle),b.rows=e.split(l,7),b.showWeeks){b.weekNumbers=[];for(var o=h(b.rows[0][0].date),p=b.rows.length;b.weekNumbers.push(o++)<p;);}},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},e.handleKeyDown=function(a,b){var c=e.activeDate.getDate();if("left"===a)c-=1;else if("up"===a)c-=7;else if("right"===a)c+=1;else if("down"===a)c+=7;else if("pageup"===a||"pagedown"===a){var d=e.activeDate.getMonth()+("pageup"===a?-1:1);e.activeDate.setMonth(d,1),c=Math.min(f(e.activeDate.getFullYear(),e.activeDate.getMonth()),c)}else"home"===a?c=1:"end"===a&&(c=f(e.activeDate.getFullYear(),e.activeDate.getMonth()));e.activeDate.setDate(c)},e.refreshView()}}}]).directive("monthpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(b,c,d,e){e.step={years:1},e.element=c,e._refreshView=function(){for(var c=new Array(12),d=e.activeDate.getFullYear(),f=0;12>f;f++)c[f]=angular.extend(e.createDateObject(new Date(d,f,1),e.formatMonth),{uid:b.uniqueId+"-"+f});b.title=a(e.activeDate,e.formatMonthTitle),b.rows=e.split(c,3)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth())-new Date(b.getFullYear(),b.getMonth());

},e.handleKeyDown=function(a,b){var c=e.activeDate.getMonth();if("left"===a)c-=1;else if("up"===a)c-=3;else if("right"===a)c+=1;else if("down"===a)c+=3;else if("pageup"===a||"pagedown"===a){var d=e.activeDate.getFullYear()+("pageup"===a?-1:1);e.activeDate.setFullYear(d)}else"home"===a?c=0:"end"===a&&(c=11);e.activeDate.setMonth(c)},e.refreshView()}}}]).directive("yearpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(a,b,c,d){function e(a){return parseInt((a-1)/f,10)*f+1}var f=d.yearRange;d.step={years:f},d.element=b,d._refreshView=function(){for(var b=new Array(f),c=0,g=e(d.activeDate.getFullYear());f>c;c++)b[c]=angular.extend(d.createDateObject(new Date(g+c,0,1),d.formatYear),{uid:a.uniqueId+"-"+c});a.title=[b[0].label,b[f-1].label].join(" - "),a.rows=d.split(b,5)},d.compare=function(a,b){return a.getFullYear()-b.getFullYear()},d.handleKeyDown=function(a,b){var c=d.activeDate.getFullYear();"left"===a?c-=1:"up"===a?c-=5:"right"===a?c+=1:"down"===a?c+=5:"pageup"===a||"pagedown"===a?c+=("pageup"===a?-1:1)*d.step.years:"home"===a?c=e(d.activeDate.getFullYear()):"end"===a&&(c=e(d.activeDate.getFullYear())+f-1),d.activeDate.setFullYear(c)},d.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(a,b,c,d,e,f,g){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(h,i,j,k){function l(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function m(a){if(a){if(angular.isDate(a)&&!isNaN(a))return k.$setValidity("date",!0),a;if(angular.isString(a)){var b=f.parse(a,n)||new Date(a);return isNaN(b)?void k.$setValidity("date",!1):(k.$setValidity("date",!0),b)}return void k.$setValidity("date",!1)}return k.$setValidity("date",!0),null}var n,o=angular.isDefined(j.closeOnDateSelection)?h.$parent.$eval(j.closeOnDateSelection):g.closeOnDateSelection,p=angular.isDefined(j.datepickerAppendToBody)?h.$parent.$eval(j.datepickerAppendToBody):g.appendToBody;h.showButtonBar=angular.isDefined(j.showButtonBar)?h.$parent.$eval(j.showButtonBar):g.showButtonBar,h.getText=function(a){return h[a+"Text"]||g[a+"Text"]},j.$observe("datepickerPopup",function(a){n=a||g.datepickerPopup,k.$render()});var q=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");q.attr({"ng-model":"date","ng-change":"dateSelection()"});var r=angular.element(q.children()[0]);j.datepickerOptions&&angular.forEach(h.$parent.$eval(j.datepickerOptions),function(a,b){r.attr(l(b),a)}),angular.forEach(["minDate","maxDate"],function(a){j[a]&&(h.$parent.$watch(b(j[a]),function(b){h[a]=b}),r.attr(l(a),a))}),j.dateDisabled&&r.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),k.$parsers.unshift(m),h.dateSelection=function(a){angular.isDefined(a)&&(h.date=a),k.$setViewValue(h.date),k.$render(),o&&(h.isOpen=!1,i[0].focus())},i.bind("input change keyup",function(){h.$apply(function(){h.date=k.$modelValue})}),k.$render=function(){var a=k.$viewValue?e(k.$viewValue,n):"";i.val(a),h.date=m(k.$modelValue)};var s=function(a){h.isOpen&&a.target!==i[0]&&h.$apply(function(){h.isOpen=!1})},t=function(a,b){h.keydown(a)};i.bind("keydown",t),h.keydown=function(a){27===a.which?(a.preventDefault(),a.stopPropagation(),h.close()):40!==a.which||h.isOpen||(h.isOpen=!0)},h.$watch("isOpen",function(a){a?(h.$broadcast("datepicker.focus"),h.position=p?d.offset(i):d.position(i),h.position.top=h.position.top+i.prop("offsetHeight"),c.bind("click",s)):c.unbind("click",s)}),h.select=function(a){if("today"===a){var b=new Date;angular.isDate(k.$modelValue)?(a=new Date(k.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate())):a=new Date(b.setHours(0,0,0,0))}h.dateSelection(a)},h.close=function(){h.isOpen=!1,i[0].focus()};var u=a(q)(h);p?c.find("body").append(u):i.after(u),h.$on("$destroy",function(){u.remove(),i.unbind("keydown",t),c.unbind("click",s)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b,c){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(a){a&&a.isDefaultPrevented()||b.$apply(function(){b.isOpen=!1})},d=function(a){27===a.which&&(b.focusToggleElement(),c())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(a,b,c,d,e,f){var g,h=this,i=a.$new(),j=d.openClass,k=angular.noop,l=b.onToggle?c(b.onToggle):angular.noop;this.init=function(d){h.$element=d,b.isOpen&&(g=c(b.isOpen),k=g.assign,a.$watch(g,function(a){i.isOpen=!!a}))},this.toggle=function(a){return i.isOpen=arguments.length?!!a:!i.isOpen},this.isOpen=function(){return i.isOpen},i.focusToggleElement=function(){h.toggleElement&&h.toggleElement[0].focus()},i.$watch("isOpen",function(b,c){f[b?"addClass":"removeClass"](h.$element,j),b?(i.focusToggleElement(),e.open(i)):e.close(i),k(a,b),angular.isDefined(b)&&b!==c&&l(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){i.isOpen=!1}),a.$on("$destroy",function(){i.$destroy()})}]).directive("dropdown",function(){return{restrict:"CA",controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownToggle",function(){return{restrict:"CA",require:"?^dropdown",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b==a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b==a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$timeout",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(b){b.animate=!1,a(function(){b.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(a,b){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"template/modal/window.html"},link:function(c,d,e){d.addClass(e.windowClass||""),c.size=e.size,b(function(){c.animate=!0,d[0].focus()}),c.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!=c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))}}}}]).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,b,c,d,e,f){function g(){for(var a=-1,b=n.keys(),c=0;c<b.length;c++)n.get(b[c]).value.backdrop&&(a=c);return a}function h(a){var b=c.find("body").eq(0),d=n.get(a).value;n.remove(a),j(d.modalDomEl,d.modalScope,300,function(){d.modalScope.$destroy(),b.toggleClass(m,n.length()>0),i()})}function i(){if(k&&-1==g()){var a=l;j(k,l,150,function(){a.$destroy(),a=null}),k=void 0,l=void 0}}function j(c,d,e,f){function g(){g.done||(g.done=!0,c.remove(),f&&f())}d.animate=!1;var h=a.transitionEndEventName;if(h){var i=b(g,e);c.bind(h,function(){b.cancel(i),g(),d.$apply()})}else b(g,0)}var k,l,m="modal-open",n=f.createNew(),o={};return e.$watch(g,function(a){l&&(l.index=a)}),c.bind("keydown",function(a){var b;27===a.which&&(b=n.top(),b&&b.value.keyboard&&(a.preventDefault(),e.$apply(function(){o.dismiss(b.key,"escape key press")})))}),o.open=function(a,b){n.add(a,{deferred:b.deferred,modalScope:b.scope,backdrop:b.backdrop,keyboard:b.keyboard});var f=c.find("body").eq(0),h=g();h>=0&&!k&&(l=e.$new(!0),l.index=h,k=d("<div modal-backdrop></div>")(l),f.append(k));var i=angular.element("<div modal-window></div>");i.attr({"template-url":b.windowTemplateUrl,"window-class":b.windowClass,size:b.size,index:n.length()-1,animate:"animate"}).html(b.content);var j=d(i)(b.scope);n.top().value.modalDomEl=j,f.append(j),f.addClass(m)},o.close=function(a,b){var c=n.get(a).value;c&&(c.deferred.resolve(b),h(a))},o.dismiss=function(a,b){var c=n.get(a).value;c&&(c.deferred.reject(b),h(a))},o.dismissAll=function(a){for(var b=this.getTop();b;)this.dismiss(b.key,a),b=this.getTop()},o.getTop=function(){return n.top()},o}]).provider("$modal",function(){var a={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(b,c,d,e,f,g,h){function i(a){return a.template?d.when(a.template):e.get(a.templateUrl,{cache:f}).then(function(a){return a.data})}function j(a){var c=[];return angular.forEach(a,function(a,e){(angular.isFunction(a)||angular.isArray(a))&&c.push(d.when(b.invoke(a)))}),c}var k={};return k.open=function(b){var e=d.defer(),f=d.defer(),k={result:e.promise,opened:f.promise,close:function(a){h.close(k,a)},dismiss:function(a){h.dismiss(k,a)}};if(b=angular.extend({},a.options,b),b.resolve=b.resolve||{},!b.template&&!b.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=d.all([i(b)].concat(j(b.resolve)));return l.then(function(a){var d=(b.scope||c).$new();d.$close=k.close,d.$dismiss=k.dismiss;var f,i={},j=1;b.controller&&(i.$scope=d,i.$modalInstance=k,angular.forEach(b.resolve,function(b,c){i[c]=a[j++]}),f=g(b.controller,i)),h.open(k,{scope:d,deferred:e,content:a[0],backdrop:b.backdrop,keyboard:b.keyboard,windowClass:b.windowClass,windowTemplateUrl:b.windowTemplateUrl,size:b.size})},function(a){e.reject(a)}),l.then(function(){f.resolve(!0)},function(){f.reject(!1)}),k},k}]};return a}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(f,g){e=f,this.config=g,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=g.itemsPerPage},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b){a.page!==b&&b>0&&b<=a.totalPages&&(e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages},a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",animation:!0,popupDelay:0},c={mouseenter:"mouseleave",click:"click",focus:"blur"},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(e,f,g,h,i,j,k){return function(e,l,m){function n(a){var b=a||o.trigger||m,d=c[b]||b;return{show:b,hide:d}}var o=angular.extend({},b,d),p=a(e),q=k.startSymbol(),r=k.endSymbol(),s="<div "+p+'-popup title="'+q+"tt_title"+r+'" content="'+q+"tt_content"+r+'" placement="'+q+"tt_placement"+r+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(a,b){var c=f(s);return function(a,b,d){function f(){a.tt_isOpen?m():k()}function k(){(!y||a.$eval(d[l+"Enable"]))&&(a.tt_popupDelay?v||(v=g(p,a.tt_popupDelay,!1),v.then(function(a){a()})):p()())}function m(){a.$apply(function(){q()})}function p(){return v=null,u&&(g.cancel(u),u=null),a.tt_content?(r(),t.css({top:0,left:0,display:"block"}),w?i.find("body").append(t):b.after(t),z(),a.tt_isOpen=!0,a.$digest(),z):angular.noop}function q(){a.tt_isOpen=!1,g.cancel(v),v=null,a.tt_animation?u||(u=g(s,500)):s()}function r(){t&&s(),t=c(a,function(){}),a.$digest()}function s(){u=null,t&&(t.remove(),t=null)}var t,u,v,w=angular.isDefined(o.appendToBody)?o.appendToBody:!1,x=n(void 0),y=angular.isDefined(d[l+"Enable"]),z=function(){var c=j.positionElements(b,t,a.tt_placement,w);c.top+="px",c.left+="px",t.css(c)};a.tt_isOpen=!1,d.$observe(e,function(b){a.tt_content=b,!b&&a.tt_isOpen&&q()}),d.$observe(l+"Title",function(b){a.tt_title=b}),d.$observe(l+"Placement",function(b){a.tt_placement=angular.isDefined(b)?b:o.placement}),d.$observe(l+"PopupDelay",function(b){var c=parseInt(b,10);a.tt_popupDelay=isNaN(c)?o.popupDelay:c});var A=function(){b.unbind(x.show,k),b.unbind(x.hide,m)};d.$observe(l+"Trigger",function(a){A(),x=n(a),x.show===x.hide?b.bind(x.show,f):(b.bind(x.show,k),b.bind(x.hide,m))});var B=a.$eval(d[l+"Animation"]);a.tt_animation=angular.isDefined(B)?!!B:o.animation,d.$observe(l+"AppendToBody",function(b){w=angular.isDefined(b)?h(b)(a):w}),w&&a.$on("$locationChangeSuccess",function(){a.tt_isOpen&&q()}),a.$on("$destroy",function(){g.cancel(u),g.cancel(v),A(),s()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(a){return a("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"templates/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(a){return a("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(a){return a("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(a,b,c){var d=this,e=angular.isDefined(b.animate)?a.$parent.$eval(b.animate):c.animate;this.bars=[],a.max=angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max,this.addBar=function(b,c){e||c.css({transition:"none"}),this.bars.push(b),b.$watch("value",function(c){b.percent=+(100*c/a.max).toFixed(2)}),b.$on("$destroy",function(){c=null,d.removeBar(b)})},this.removeBar=function(a){this.bars.splice(this.bars.indexOf(a),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(a,b,c,d){d.addBar(a,b)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(a,b,c,d){d.addBar(a,angular.element(b.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(a,b,c){var d={$setViewValue:angular.noop};this.init=function(e){d=e,d.$render=this.render,this.stateOn=angular.isDefined(b.stateOn)?a.$parent.$eval(b.stateOn):c.stateOn,this.stateOff=angular.isDefined(b.stateOff)?a.$parent.$eval(b.stateOff):c.stateOff;var f=angular.isDefined(b.ratingStates)?a.$parent.$eval(b.ratingStates):new Array(angular.isDefined(b.max)?a.$parent.$eval(b.max):c.max);a.range=this.buildTemplateObjects(f)},this.buildTemplateObjects=function(a){for(var b=0,c=a.length;c>b;b++)a[b]=angular.extend({index:b},{stateOn:this.stateOn,stateOff:this.stateOff},a[b]);return a},a.rate=function(b){!a.readonly&&b>=0&&b<=a.range.length&&(d.$setViewValue(b),d.$render())},a.enter=function(b){a.readonly||(a.value=b),a.onHover({value:b})},a.reset=function(){a.value=d.$viewValue,a.onLeave()},a.onKeydown=function(b){/(37|38|39|40)/.test(b.which)&&(b.preventDefault(),b.stopPropagation(),a.rate(a.value+(38===b.which||39===b.which?1:-1)))},this.render=function(){a.value=d.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect())}),a.active=!0,a.onSelect()},b.addTab=function(a){c.push(a),1===c.length?a.active=!0:a.active&&b.select(a)},b.removeTab=function(a){var d=c.indexOf(a);if(a.active&&c.length>1){var e=d==c.length-1?d-1:d+1;b.select(c[e])}c.splice(d,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(a,b,c){a.vertical=angular.isDefined(c.vertical)?a.$parent.$eval(c.vertical):!1,a.justified=angular.isDefined(c.justified)?a.$parent.$eval(c.justified):!1}}}).directive("tab",["$parse",function(a){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(b,c,d){return function(b,c,e,f){b.$watch("active",function(a){a&&f.select(b)}),b.disabled=!1,e.disabled&&b.$parent.$watch(a(e.disabled),function(a){b.disabled=!!a}),b.select=function(){b.disabled||(b.active=!0)},f.addTab(b),b.$on("$destroy",function(){f.removeTab(b)}),b.$transcludeFn=d}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(a,b,c,d){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("tabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("tab-heading")||a.hasAttribute("data-tab-heading")||"tab-heading"===a.tagName.toLowerCase()||"data-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(b,c,d){var e=b.$eval(d.tabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(a,b,c,d,e,f){function g(){var b=parseInt(a.hours,10),c=a.showMeridian?b>0&&13>b:b>=0&&24>b;return c?(a.showMeridian&&(12===b&&(b=0),a.meridian===p[1]&&(b+=12)),b):void 0}function h(){var b=parseInt(a.minutes,10);return b>=0&&60>b?b:void 0}function i(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a}function j(a){k(),o.$setViewValue(new Date(n)),l(a)}function k(){o.$setValidity("time",!0),a.invalidHours=!1,a.invalidMinutes=!1}function l(b){var c=n.getHours(),d=n.getMinutes();a.showMeridian&&(c=0===c||12===c?12:c%12),a.hours="h"===b?c:i(c),a.minutes="m"===b?d:i(d),a.meridian=n.getHours()<12?p[0]:p[1]}function m(a){var b=new Date(n.getTime()+6e4*a);n.setHours(b.getHours(),b.getMinutes()),j()}var n=new Date,o={$setViewValue:angular.noop},p=angular.isDefined(b.meridians)?a.$parent.$eval(b.meridians):f.meridians||e.DATETIME_FORMATS.AMPMS;this.init=function(c,d){o=c,o.$render=this.render;var e=d.eq(0),g=d.eq(1),h=angular.isDefined(b.mousewheel)?a.$parent.$eval(b.mousewheel):f.mousewheel;h&&this.setupMousewheelEvents(e,g),a.readonlyInput=angular.isDefined(b.readonlyInput)?a.$parent.$eval(b.readonlyInput):f.readonlyInput,this.setupInputEvents(e,g)};var q=f.hourStep;b.hourStep&&a.$parent.$watch(c(b.hourStep),function(a){q=parseInt(a,10)});var r=f.minuteStep;b.minuteStep&&a.$parent.$watch(c(b.minuteStep),function(a){r=parseInt(a,10)}),a.showMeridian=f.showMeridian,b.showMeridian&&a.$parent.$watch(c(b.showMeridian),function(b){if(a.showMeridian=!!b,o.$error.time){var c=g(),d=h();angular.isDefined(c)&&angular.isDefined(d)&&(n.setHours(c),j())}else l()}),this.setupMousewheelEvents=function(b,c){var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementHours():a.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){a.$apply(d(b)?a.incrementMinutes():a.decrementMinutes()),b.preventDefault()})},this.setupInputEvents=function(b,c){if(a.readonlyInput)return a.updateHours=angular.noop,void(a.updateMinutes=angular.noop);var d=function(b,c){o.$setViewValue(null),o.$setValidity("time",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c)};a.updateHours=function(){var a=g();angular.isDefined(a)?(n.setHours(a),j("h")):d(!0)},b.bind("blur",function(b){!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=i(a.hours)})}),a.updateMinutes=function(){var a=h();angular.isDefined(a)?(n.setMinutes(a),j("m")):d(void 0,!0)},c.bind("blur",function(b){!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=i(a.minutes)})})},this.render=function(){var a=o.$modelValue?new Date(o.$modelValue):null;isNaN(a)?(o.$setValidity("time",!1),d.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(a&&(n=a),k(),l())},a.incrementHours=function(){m(60*q)},a.decrementHours=function(){m(60*-q)},a.incrementMinutes=function(){m(r)},a.decrementMinutes=function(){m(-r)},a.toggleMeridian=function(){m(720*(n.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(a){var b=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(c){var d=c.match(b);if(!d)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+c+'".');return{itemName:d[3],source:a(d[4]),viewMapper:a(d[2]||d[1]),modelMapper:a(d[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(a,b,c,d,e,f,g){var h=[9,13,27,38,40];return{require:"ngModel",link:function(i,j,k,l){var m,n=i.$eval(k.typeaheadMinLength)||1,o=i.$eval(k.typeaheadWaitMs)||0,p=i.$eval(k.typeaheadEditable)!==!1,q=b(k.typeaheadLoading).assign||angular.noop,r=b(k.typeaheadOnSelect),s=k.typeaheadInputFormatter?b(k.typeaheadInputFormatter):void 0,t=k.typeaheadAppendToBody?i.$eval(k.typeaheadAppendToBody):!1,u=b(k.ngModel).assign,v=g.parse(k.typeahead),w=i.$new();i.$on("$destroy",function(){w.$destroy()});var x="typeahead-"+w.$id+"-"+Math.floor(1e4*Math.random());j.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":x});var y=angular.element("<div typeahead-popup></div>");y.attr({id:x,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(k.typeaheadTemplateUrl)&&y.attr("template-url",k.typeaheadTemplateUrl);var z=function(){w.matches=[],w.activeIdx=-1,j.attr("aria-expanded",!1)},A=function(a){return x+"-option-"+a};w.$watch("activeIdx",function(a){0>a?j.removeAttr("aria-activedescendant"):j.attr("aria-activedescendant",A(a))});var B=function(a){var b={$viewValue:a};q(i,!0),c.when(v.source(i,b)).then(function(c){var d=a===l.$viewValue;if(d&&m)if(c.length>0){w.activeIdx=0,w.matches.length=0;for(var e=0;e<c.length;e++)b[v.itemName]=c[e],w.matches.push({id:A(e),label:v.viewMapper(w,b),model:c[e]});w.query=a,w.position=t?f.offset(j):f.position(j),w.position.top=w.position.top+j.prop("offsetHeight"),j.attr("aria-expanded",!0)}else z();d&&q(i,!1)},function(){z(),q(i,!1)})};z(),w.query=void 0;var C;l.$parsers.unshift(function(a){return m=!0,a&&a.length>=n?o>0?(C&&d.cancel(C),C=d(function(){B(a)},o)):B(a):(q(i,!1),z()),p?a:a?void l.$setValidity("editable",!1):(l.$setValidity("editable",!0),a)}),l.$formatters.push(function(a){var b,c,d={};return s?(d.$model=a,s(i,d)):(d[v.itemName]=a,b=v.viewMapper(i,d),d[v.itemName]=void 0,c=v.viewMapper(i,d),b!==c?b:a)}),w.select=function(a){var b,c,e={};e[v.itemName]=c=w.matches[a].model,b=v.modelMapper(i,e),u(i,b),l.$setValidity("editable",!0),r(i,{$item:c,$model:b,$label:v.viewMapper(i,e)}),z(),d(function(){j[0].focus()},0,!1)},j.bind("keydown",function(a){0!==w.matches.length&&-1!==h.indexOf(a.which)&&(a.preventDefault(),40===a.which?(w.activeIdx=(w.activeIdx+1)%w.matches.length,w.$digest()):38===a.which?(w.activeIdx=(w.activeIdx?w.activeIdx:w.matches.length)-1,w.$digest()):13===a.which||9===a.which?w.$apply(function(){w.select(w.activeIdx)}):27===a.which&&(a.stopPropagation(),z(),w.$digest()))}),j.bind("blur",function(a){m=!1});var D=function(a){j[0]!==a.target&&(z(),w.$digest())};e.bind("click",D),i.$on("$destroy",function(){e.unbind("click",D)});var E=a(y)(w);t?e.find("body").append(E):j.after(E)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(a,b,c){a.templateUrl=c.templateUrl,a.isOpen=function(){return a.matches.length>0},a.isActive=function(b){return a.active==b},a.selectActive=function(b){a.active=b},a.selectMatch=function(b){a.select({activeIdx:b})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(a,b,c,d){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(e,f,g){var h=d(g.templateUrl)(e.$parent)||"template/typeahead/typeahead-match.html";a.get(h,{cache:b}).success(function(a){f.replaceWith(c(a.trim())(e))})}}}]).filter("typeaheadHighlight",function(){function a(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(b,c){return c?(""+b).replace(new RegExp(a(c),"gi"),"<strong>$&</strong>"):b}}),app.controller("loggerController",["$scope","$filter","loggerService",function(a,b,c){a.log=c,a.Date=Date,a.form={logDate:"",logTime:"",logCallsign:"",logSummit:"",logBand:"",logMode:"",logEditMode:!1}}]).factory("loggerService",["$log","$filter","$window",function(a,b,c){var d={};try{localStorage.setItem("test","test"),localStorage.removeItem("test"),d.localStorageIsSupported=!0}catch(e){d.localStorageIsSupported=!1}return d.localStorageIsSupported&&(d.myCallsign=localStorage.getItem("log-mycallsign")?localStorage.getItem("log-mycallsign"):"",d.mySummit=localStorage.getItem("log-mysummit")?localStorage.getItem("log-mysummit"):"",d.loglist=[],function(){var b=localStorage.getItem("log-array");if(b){a.debug("Importing log");var c=b.split("\n");for(var e in c){a.debug(e+" entry");var f=c[e].split(";");d.loglist.push({callsign:f[0],summit:f[1],band:f[2],mode:f[3],date:f[4],time:f[5]})}}}()),"undefined"==typeof d.myCallsign&&(d.myCallsign=""),"undefined"==typeof d.mySummit&&(d.mySummit=""),"undefined"==typeof d.loglist&&(d.loglist=[]),d.save=function(){if(d.localStorageIsSupported){d.myCallsign&&localStorage.setItem("log-mycallsign",d.myCallsign),d.mySummit&&localStorage.setItem("log-mysummit",d.mySummit);var b="";for(var c in d.loglist)b+=d.loglist[c].callsign+";"+d.loglist[c].summit+";"+d.loglist[c].band+";"+d.loglist[c].mode+";"+d.loglist[c].date+";"+d.loglist[c].time+"\n";localStorage.setItem("log-array",b.slice(0,-1)),a.debug("Log saved")}},d.add=function(a,e,f,g,h,i){"undefined"==typeof h&&(h=b("date")(new Date,"dd/MM/yy","UTC")),"undefined"==typeof i&&(i=b("date")(new Date,"HH:mm","UTC")),a=a.replace(/[^\w\d\/\-]/gi,""),e=e.replace(/[^\w\d\/\-\?]/gi,""),f=f.replace(/[^\.\d]/gi,""),g=g.replace(/[^\w]/gi,""),h=h.replace(/[^\d\/]/gi,""),i=i.replace(/[^:\d]/gi,""),d.loglist.push({date:h,callsign:a,summit:e,time:i,band:f,mode:g}),d.sort(),d.save(),c.ga("send","event","logger","add","Added a new spot to the log")},d.remove=function(a,b,c,e){for(var f in d.loglist)if(d.loglist[f].callsign===a&&d.loglist[f].summit===b&&d.loglist[f].band==c&&d.loglist[f].mode===e)return d.loglist.splice(f,1),void d.save()},d.sort=function(){d.loglist.sort(function(a,b){return a_date=a.date.split("/"),b_date=b.date.split("/"),a_date[2]<b_date[2]?-1:a_date[2]>b_date[2]?1:a_date[1]<b_date[1]?-1:a_date[1]>b_date[1]?1:a_date[0]<b_date[0]?-1:a_date[0]>b_date[0]?1:(a_time=a.time.split(":"),b_time=b.time.split(":"),a_time[0]<b_time[0]?-1:a_time[0]>b_time[0]?1:a_time[1]<b_time[1]?-1:a_time[1]>b_time[1]?1:0);

})},d.clear=function(){d.loglist=[],d.save()},d["export"]=function(){var a="";for(var e in d.loglist)a+="V2,"+(d.myCallsign?d.myCallsign:"")+","+(d.mySummit?d.mySummit:"")+","+d.loglist[e].date+","+d.loglist[e].time.replace(":","")+","+giveBand(parseFloat(d.loglist[e].band))+"MHz,"+d.loglist[e].mode+","+d.loglist[e].callsign+","+d.loglist[e].summit+"\r\n";var f=new Blob([a],{type:"text/plain;charset=utf-8"});saveAs(f,"SOTAwatchfilter-log-"+b("date")(new Date,"yyyyMMdd","UTC")+"-"+b("date")(new Date,"HHmm","UTC")+".csv"),c.ga("send","event","logger","download","Log file was downloaded")},d.isInLog=function(a,b){for(var c in d.loglist)if(d.stripP(d.loglist[c].callsign)==d.stripP(a)&&d.loglist[c].summit==b)return!0;return!1},d.stripP=function(a){return a.replace(/\/P$/,"")},d}]),app.controller("sidebarController",["$scope","$location","$routeParams","$log","SpotsService",function(a,b,c,d,e){a.spots=e,a.$on("$routeChangeSuccess",function(c){a.currentView=b.path(),d.debug(a.currentView),("/spotfilter"===a.currentView||"/"===a.currentView)&&a.spots.resetNumberOfNewSpots()}),a.$watch("spots.numberOfNewSpots",function(){("/spotfilter"===a.currentView||"/"===a.currentView)&&a.spots.resetNumberOfNewSpots()})}]).filter("numberOfBadges",["$log","$filter","settingsService","SoundNotification","SpotsService",function(a,b,c,d,e){return function(a){if(filterSettings=c,objectSpots=e,objectSpots.newSpots){a=b("matchSpots")(a);for(var d in a)a[d].isNew&&a[d].match&&objectSpots.numberOfNewSpots++;objectSpots.newSpots=!1}return objectSpots.numberOfNewSpots}}]),app.directive("checkEmpty",function(){return{link:function(a,b,c){b.on("blur",function(){""===b.val()&&b.val(c.checkEmpty)})}}}).directive("checkInRange",["$log","$parse",function(a,b){return{require:"ngModel",scope:{save:"&save"},link:function(b,c,d,e){var f=parseInt(d.mdMin,10),g=parseInt(d.mdMax,10);b.$watch(function(){return e.$modelValue},function(){a.debug(e.$modelValue),e.$modelValue>g&&(e.$setViewValue(g),e.$render()),e.$modelValue<f&&(e.$setViewValue(f),e.$render()),b.save&&b.save()})}}}]),app.controller("settingsController",["$scope","settingsService","SoundNotification","loggerService",function(a,b,c,d){a.spotfilter=b,a.logger=d,a.soundNotification=c}]).controller("AudioSettingsController",["$scope","SoundNotification",function(a,b){a.soundNotification=b,a.unmute=!a.soundNotification.spotsMute,a.$watch("soundNotification.spotsMute",function(b){a.unmute=!b}),a.$watch("unmute",function(b){a.soundNotification.spotsMute=!b,a.soundNotification.save()})}]).factory("settingsService",["$log",function(a){var b={callsign:{},summit:{},comment:{},band:{},mode:{}};try{localStorage.setItem("test","test"),localStorage.removeItem("test"),b.localStorageIsSupported=!0}catch(c){b.localStorageIsSupported=!1}return b.localStorageIsSupported&&(b.callsign.include=localStorage.getItem("callsignInclude"),b.callsign.exclude=localStorage.getItem("callsignExclude"),b.summit.include=localStorage.getItem("summitInclude"),b.summit.exclude=localStorage.getItem("summitExclude"),b.comment.include=localStorage.getItem("commentInclude"),b.comment.exclude=localStorage.getItem("commentExclude"),b.band[160]="false"===localStorage.getItem("band160")?!1:!0,b.band[80]="false"===localStorage.getItem("band80")?!1:!0,b.band[60]="false"===localStorage.getItem("band60")?!1:!0,b.band[40]="false"===localStorage.getItem("band40")?!1:!0,b.band[30]="false"===localStorage.getItem("band30")?!1:!0,b.band[20]="false"===localStorage.getItem("band20")?!1:!0,b.band[17]="false"===localStorage.getItem("band17")?!1:!0,b.band[15]="false"===localStorage.getItem("band15")?!1:!0,b.band[12]="false"===localStorage.getItem("band12")?!1:!0,b.band[10]="false"===localStorage.getItem("band10")?!1:!0,b.band[6]="false"===localStorage.getItem("band6")?!1:!0,b.band[4]="false"===localStorage.getItem("band4")?!1:!0,b.band[2]="false"===localStorage.getItem("band2")?!1:!0,b.band[70]="false"===localStorage.getItem("band70")?!1:!0,b.band[23]="false"===localStorage.getItem("band23")?!1:!0,b.band[13]="false"===localStorage.getItem("band13")?!1:!0,b.band.others="false"===localStorage.getItem("bandOthers")?!1:!0,b.mode.cw="false"===localStorage.getItem("modeCW")?!1:!0,b.mode.ssb="false"===localStorage.getItem("modeSSB")?!1:!0,b.mode.fm="false"===localStorage.getItem("modeFM")?!1:!0,b.mode.others="false"===localStorage.getItem("modeOthers")?!1:!0,b.points=parseInt(localStorage.getItem("points"),10),b.hideMatched="false"===localStorage.getItem("hideMatched")?!1:!0,b.highlightRejected="false"===localStorage.getItem("highlightRejected")?!1:!0,b.highlightMatched="true"===localStorage.getItem("highlightMatched")?!0:!1,b.hideLog="false"===localStorage.getItem("hideLog")?!1:!0),b.callsign.include=b.callsign.include||".*",b.callsign.exclude=b.callsign.exclude||"",b.summit.include=b.summit.include||".*",b.summit.exclude=b.summit.exclude||"",b.comment.include=b.comment.include||".*",b.comment.exclude=b.comment.exclude||"(test|ignore)",b.band[160]="undefined"!=typeof b.band[160]?b.band[160]:!0,b.band[80]="undefined"!=typeof b.band[80]?b.band[80]:!0,b.band[60]="undefined"!=typeof b.band[60]?b.band[60]:!0,b.band[40]="undefined"!=typeof b.band[40]?b.band[40]:!0,b.band[30]="undefined"!=typeof b.band[30]?b.band[30]:!0,b.band[20]="undefined"!=typeof b.band[20]?b.band[20]:!0,b.band[17]="undefined"!=typeof b.band[17]?b.band[17]:!0,b.band[15]="undefined"!=typeof b.band[15]?b.band[15]:!0,b.band[12]="undefined"!=typeof b.band[12]?b.band[12]:!0,b.band[10]="undefined"!=typeof b.band[10]?b.band[10]:!0,b.band[6]="undefined"!=typeof b.band[6]?b.band[6]:!0,b.band[4]="undefined"!=typeof b.band[4]?b.band[4]:!0,b.band[2]="undefined"!=typeof b.band[2]?b.band[2]:!0,b.band[70]="undefined"!=typeof b.band[70]?b.band[70]:!0,b.band[23]="undefined"!=typeof b.band[23]?b.band[23]:!0,b.band[13]="undefined"!=typeof b.band[13]?b.band[13]:!0,b.band.others="undefined"!=typeof b.band.others?b.band.others:!0,b.mode.cw="undefined"!=typeof b.mode.cw?b.mode.cw:!0,b.mode.ssb="undefined"!=typeof b.mode.ssb?b.mode.ssb:!0,b.mode.fm="undefined"!=typeof b.mode.fm?b.mode.fm:!0,b.mode.others="undefined"!=typeof b.mode.others?b.mode.others:!0,b.points=b.points||0,a.debug("spotfilter settings are:"),a.debug(b),b.save=function(){b.localStorageIsSupported&&(a.debug("Saving spotfilter settings:"),a.debug(b),localStorage.setItem("callsignInclude",b.callsign.include),localStorage.setItem("callsignExclude",b.callsign.exclude),localStorage.setItem("summitInclude",b.summit.include),localStorage.setItem("summitExclude",b.summit.exclude),localStorage.setItem("commentInclude",b.comment.include),localStorage.setItem("commentExclude",b.comment.exclude),localStorage.setItem("band160",b.band[160]),localStorage.setItem("band80",b.band[80]),localStorage.setItem("band60",b.band[60]),localStorage.setItem("band40",b.band[40]),localStorage.setItem("band30",b.band[30]),localStorage.setItem("band20",b.band[20]),localStorage.setItem("band17",b.band[17]),localStorage.setItem("band15",b.band[15]),localStorage.setItem("band12",b.band[12]),localStorage.setItem("band10",b.band[10]),localStorage.setItem("band6",b.band[6]),localStorage.setItem("band4",b.band[4]),localStorage.setItem("band2",b.band[2]),localStorage.setItem("band70",b.band[70]),localStorage.setItem("band23",b.band[23]),localStorage.setItem("band13",b.band[13]),localStorage.setItem("bandOthers",b.band.others),localStorage.setItem("modeCW",b.mode.cw),localStorage.setItem("modeSSB",b.mode.ssb),localStorage.setItem("modeFM",b.mode.fm),localStorage.setItem("modeOthers",b.mode.others),localStorage.setItem("points",b.points),localStorage.setItem("hideMatched",b.hideMatched),localStorage.setItem("highlightRejected",b.highlightRejected),localStorage.setItem("highlightMatched",b.highlightMatched),localStorage.setItem("hideLog",b.hideLog))},b.reset=function(){b.callsign.include=".*",b.callsign.exclude="",b.summit.include=".*",b.summit.exclude="",b.comment.include=".*",b.comment.exclude="(test|ignore)",b.band[160]=!0,b.band[80]=!0,b.band[60]=!0,b.band[40]=!0,b.band[30]=!0,b.band[20]=!0,b.band[17]=!0,b.band[15]=!0,b.band[12]=!0,b.band[10]=!0,b.band[6]=!0,b.band[4]=!0,b.band[2]=!0,b.band[70]=!0,b.band[23]=!0,b.band[13]=!0,b.band.others=!0,b.mode.cw=!0,b.mode.ssb=!0,b.mode.fm=!0,b.mode.others=!0,b.points=0,b.save()},b.toggleBand=function(){var c=0,d=0;for(var e in b.band)a.debug(b.band[e]),b.band[e]===!0&&c++,d++;for(e in b.band)b.band[e]=c>=d/2?!1:!0;b.save()},b}]),app.controller("spotfilterController",["$scope","$window","SpotsService","loggerService","alertService","settingsService",function(a,b,c,d,e,f){a.spots=c,a.logger=d,a.tooltipPosition=b.innerWidth>1050?"right":"top",a.alert=e,a.settings=f,a.$watch("settings.hideMatched",function(){a.settings.save()}),angular.element(b).bind("resize",function(){return a.tooltipPosition=b.innerWidth>1050?"right":"top",a.$apply()})}]).factory("SpotsService",["$timeout","$http","$log","$q","$window","SoundNotification","alertService",function(a,b,c,d,e,f,g){var h={};return h.spots=[],h.numberOfNewSpots=0,h.newSpots=!1,h.firstLoad=!0,alert=g,h.refresh=function(){var f=d.defer(),g=(new Date).getTime();try{b.get("http://www.on6zq.be/cgi-bin/SOTAspots2Json.cgi",{timeout:f.promise}).success(function(b){h.oldSpots=h.spots,h.spots=h.processSpots(b.aaData,h.oldSpots),h.lastUpdate=new Date,h.playSound=!0,e.ga("send","event","fetch","spots"),a(h.refresh,2e4+5e3*Math.random())}).error(function(b,d,e,f){c.error("Error in the AJAX call to the server, status code: "+d);var i=(new Date).getTime()-g;i>=f.timeout?alert.addAlert("SOTAwatch filter could not reach the server, trying again in a few seconds","warning",8e3):c.error("Not a timeout error: "),a(h.refresh,1e4+5e3*Math.random())})}catch(i){c.error("An error occured: "+i.message)}a(function(){f.resolve()},1e4)},h.processSpots=function(a,b){var c=[],d=!0,e=0;for(var g in a)c.push({index:e,operator:a[g][0],summitName:a[g][1],altitude:a[g][2],points:""!==a[g][3]?parseInt(a[g][3],10):"",date:a[g][4],callsign:a[g][5],callsign_without_p:a[g][5].replace(/\/P$/,""),summitReference:a[g][6],frequency:parseFloat(a[g][7]),frequencyString:a[g][7],mode:a[g][8],comment:a[g][9],postedBy:a[g][10],isNew:!1}),e++,d&&b.length>0?b[0].summitReference!==c[c.length-1].summitReference||b[0].callsign_without_p!==c[c.length-1].callsign_without_p||b[0].frequency!==c[c.length-1].frequency?(c[c.length-1].isNew=!0,h.newSpots=!0):(c[c.length-1].isNew=!1,d=!1):0!==b.length||h.firstLoad||(c[c.length-1].isNew=!0);return h.firstLoad=!1,f.playSpots(c),c},h.resetNumberOfNewSpots=function(){h.numberOfNewSpots=0},h.setHover=function(a){if("undefined"!==a&&a>=0){for(var b in h.spots)if(h.spots[b].index===a){h.spotHovered=b;break}}else h.spotHovered=null;for(var c in h.spots)c===h.spotHovered?(h.spots[c].activeHover=!0,h.spots[c].passiveHover=!1):null!==h.spotHovered&&h.spots[c].callsign===h.spots[h.spotHovered].callsign?(h.spots[c].activeHover=!1,h.spots[c].passiveHover=!0):(h.spots[c].activeHover=!1,h.spots[c].passiveHover=!1)},h.refresh(),h}]);